{% extends 'produkty/base.html' %}

{% block title %}
    {% if form.instance.pk %}Edytuj Zadaniówkę{% else %}Dodaj Nową Zadaniówkę{% endif %}
{% endblock %}

{% block content %}
<div class="container mt-4">
    <h2>{% if form.instance.pk %}Edytuj Zadaniówkę{% else %}Dodaj Nową Zadaniówkę{% endif %}</h2>

    <form method="get" class="mb-4">
        <div class="row align-items-end">
            <div class="col-md-8">
                <label for="product-filter" class="form-label">Filtruj produkty</label>
                <input type="text" id="product-filter" name="product_filter" class="form-control" 
                       placeholder="Wpisz, aby filtrować..." value="{{ product_filter|default:'' }}">
            </div>
            <div class="col-md-4">
                <button type="submit" class="btn btn-secondary w-100">Filtruj</button>
            </div>
        </div>
    </form>
    
    <form method="post" class="mt-4">
        {% csrf_token %}
        
        {% if form.non_field_errors %}
            <div class="alert alert-danger">
                {{ form.non_field_errors }}
            </div>
        {% endif %}

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.nazwa.id_for_label }}" class="form-label">{{ form.nazwa.label }}</label>
                {{ form.nazwa }}
                {% if form.nazwa.errors %}<div class="invalid-feedback d-block">{{ form.nazwa.errors }}</div>{% endif %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.data_od.id_for_label }}" class="form-label">{{ form.data_od.label }}</label>
                {{ form.data_od }}
                {% if form.data_od.errors %}<div class="invalid-feedback d-block">{{ form.data_od.errors }}</div>{% endif %}
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.data_do.id_for_label }}" class="form-label">{{ form.data_do.label }}</label>
                {{ form.data_do }}
                {% if form.data_do.errors %}<div class="invalid-feedback d-block">{{ form.data_do.errors }}</div>{% endif %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.opis.id_for_label }}" class="form-label">{{ form.opis.label }}</label>
                {{ form.opis }}
                {% if form.opis.errors %}<div class="invalid-feedback d-block">{{ form.opis.errors }}</div>{% endif %}
            </div>
        </div>

        <div id="konkretne-modele-fields" class="mb-3">
            <label for="{{ form.produkty.id_for_label }}" class="form-label">{{ form.produkty.label }}</label>
            {{ form.produkty }}
            {% if form.produkty.errors %}<div class="invalid-feedback d-block">{{ form.produkty.errors }}</div>{% endif %}
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.prog_ilosc_1.id_for_label }}" class="form-label">{{ form.prog_ilosc_1.label }}</label>
                {{ form.prog_ilosc_1 }}
                {% if form.prog_ilosc_1.errors %}<div class="invalid-feedback d-block">{{ form.prog_ilosc_1.errors }}</div>{% endif %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.prog_premia_1.id_for_label }}" class="form-label">{{ form.prog_premia_1.label }}</label>
                {{ form.prog_premia_1 }}
                {% if form.prog_premia_1.errors %}<div class="invalid-feedback d-block">{{ form.prog_premia_1.errors }}</div>{% endif %}
            </div>
        </div>

        <div class="row">
            <div class="col-md-6 mb-3">
                <label for="{{ form.prog_ilosc_2.id_for_label }}" class="form-label">{{ form.prog_ilosc_2.label }}</label>
                {{ form.prog_ilosc_2 }}
                {% if form.prog_ilosc_2.errors %}<div class="invalid-feedback d-block">{{ form.prog_ilosc_2.errors }}</div>{% endif %}
            </div>
            <div class="col-md-6 mb-3">
                <label for="{{ form.prog_premia_2.id_for_label }}" class="form-label">{{ form.prog_premia_2.label }}</label>
                {{ form.prog_premia_2 }}
                {% if form.prog_premia_2.errors %}<div class="invalid-feedback d-block">{{ form.prog_premia_2.errors }}</div>{% endif %}
            </div>
        </div>
        
        <div class="mb-3">
            <button type="submit" class="btn btn-primary">Zapisz</button>
            <a href="{% url 'produkty:zadaniowki_management' %}" class="btn btn-secondary">Anuluj</a>
        </div>
    </form>
</div>
{% endblock %}